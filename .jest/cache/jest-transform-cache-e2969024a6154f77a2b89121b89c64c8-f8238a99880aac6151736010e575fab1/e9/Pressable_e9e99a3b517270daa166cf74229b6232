d921137c54e591a3fd12d181f6769dd7
'use strict';

var _interopRequireWildcard = require("@babel/runtime/helpers/interopRequireWildcard");

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _extends2 = _interopRequireDefault(require("@babel/runtime/helpers/extends"));

var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime/helpers/slicedToArray"));

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

var React = _interopRequireWildcard(require("react"));

var _useAndroidRippleForView = _interopRequireDefault(require("./useAndroidRippleForView"));

var _PressabilityDebug = require("../../Pressability/PressabilityDebug");

var _usePressability = _interopRequireDefault(require("../../Pressability/usePressability"));

var _Rect = require("../../StyleSheet/Rect");

var _View = _interopRequireDefault(require("../View/View"));

function Pressable(props, forwardedRef) {
  var accessible = props.accessible,
      android_disableSound = props.android_disableSound,
      android_ripple = props.android_ripple,
      children = props.children,
      delayLongPress = props.delayLongPress,
      disabled = props.disabled,
      focusable = props.focusable,
      onLongPress = props.onLongPress,
      onPress = props.onPress,
      _onPressIn = props.onPressIn,
      _onPressOut = props.onPressOut,
      pressRetentionOffset = props.pressRetentionOffset,
      style = props.style,
      testOnly_pressed = props.testOnly_pressed,
      unstable_pressDelay = props.unstable_pressDelay,
      restProps = (0, _objectWithoutProperties2.default)(props, ["accessible", "android_disableSound", "android_ripple", "children", "delayLongPress", "disabled", "focusable", "onLongPress", "onPress", "onPressIn", "onPressOut", "pressRetentionOffset", "style", "testOnly_pressed", "unstable_pressDelay"]);
  var viewRef = (0, React.useRef)(null);
  (0, React.useImperativeHandle)(forwardedRef, function () {
    return viewRef.current;
  });
  var android_rippleConfig = (0, _useAndroidRippleForView.default)(android_ripple, viewRef);

  var _usePressState = usePressState(testOnly_pressed === true),
      _usePressState2 = (0, _slicedToArray2.default)(_usePressState, 2),
      pressed = _usePressState2[0],
      setPressed = _usePressState2[1];

  var hitSlop = (0, _Rect.normalizeRect)(props.hitSlop);
  var config = (0, React.useMemo)(function () {
    return {
      disabled: disabled,
      hitSlop: hitSlop,
      pressRectOffset: pressRetentionOffset,
      android_disableSound: android_disableSound,
      delayLongPress: delayLongPress,
      delayPressIn: unstable_pressDelay,
      onLongPress: onLongPress,
      onPress: onPress,
      onPressIn: function onPressIn(event) {
        if (android_rippleConfig != null) {
          android_rippleConfig.onPressIn(event);
        }

        setPressed(true);

        if (_onPressIn != null) {
          _onPressIn(event);
        }
      },
      onPressMove: android_rippleConfig == null ? void 0 : android_rippleConfig.onPressMove,
      onPressOut: function onPressOut(event) {
        if (android_rippleConfig != null) {
          android_rippleConfig.onPressOut(event);
        }

        setPressed(false);

        if (_onPressOut != null) {
          _onPressOut(event);
        }
      }
    };
  }, [android_disableSound, android_rippleConfig, delayLongPress, disabled, hitSlop, onLongPress, onPress, _onPressIn, _onPressOut, pressRetentionOffset, setPressed, unstable_pressDelay]);
  var eventHandlers = (0, _usePressability.default)(config);
  return React.createElement(_View.default, (0, _extends2.default)({}, restProps, eventHandlers, android_rippleConfig == null ? void 0 : android_rippleConfig.viewProps, {
    accessible: accessible !== false,
    focusable: focusable !== false,
    hitSlop: hitSlop,
    ref: viewRef,
    style: typeof style === 'function' ? style({
      pressed: pressed
    }) : style
  }), typeof children === 'function' ? children({
    pressed: pressed
  }) : children, __DEV__ ? React.createElement(_PressabilityDebug.PressabilityDebugView, {
    color: "red",
    hitSlop: hitSlop
  }) : null);
}

function usePressState(forcePressed) {
  var _useState = (0, React.useState)(false),
      _useState2 = (0, _slicedToArray2.default)(_useState, 2),
      pressed = _useState2[0],
      setPressed = _useState2[1];

  return [pressed || forcePressed, setPressed];
}

var MemoedPressable = React.memo(React.forwardRef(Pressable));
MemoedPressable.displayName = 'Pressable';
var _default = MemoedPressable;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlByZXNzYWJsZS5qcyJdLCJuYW1lcyI6WyJQcmVzc2FibGUiLCJwcm9wcyIsImZvcndhcmRlZFJlZiIsImFjY2Vzc2libGUiLCJhbmRyb2lkX2Rpc2FibGVTb3VuZCIsImFuZHJvaWRfcmlwcGxlIiwiY2hpbGRyZW4iLCJkZWxheUxvbmdQcmVzcyIsImRpc2FibGVkIiwiZm9jdXNhYmxlIiwib25Mb25nUHJlc3MiLCJvblByZXNzIiwib25QcmVzc0luIiwib25QcmVzc091dCIsInByZXNzUmV0ZW50aW9uT2Zmc2V0Iiwic3R5bGUiLCJ0ZXN0T25seV9wcmVzc2VkIiwidW5zdGFibGVfcHJlc3NEZWxheSIsInJlc3RQcm9wcyIsInZpZXdSZWYiLCJjdXJyZW50IiwiYW5kcm9pZF9yaXBwbGVDb25maWciLCJ1c2VQcmVzc1N0YXRlIiwicHJlc3NlZCIsInNldFByZXNzZWQiLCJoaXRTbG9wIiwiY29uZmlnIiwicHJlc3NSZWN0T2Zmc2V0IiwiZGVsYXlQcmVzc0luIiwiZXZlbnQiLCJvblByZXNzTW92ZSIsImV2ZW50SGFuZGxlcnMiLCJ2aWV3UHJvcHMiLCJfX0RFVl9fIiwiZm9yY2VQcmVzc2VkIiwiTWVtb2VkUHJlc3NhYmxlIiwiUmVhY3QiLCJtZW1vIiwiZm9yd2FyZFJlZiIsImRpc3BsYXlOYW1lIl0sIm1hcHBpbmdzIjoiQUFVQTs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFQTs7QUFFQTs7QUFVQTs7QUFDQTs7QUFDQTs7QUFHQTs7QUFtSEEsU0FBU0EsU0FBVCxDQUFtQkMsS0FBbkIsRUFBaUNDLFlBQWpDLEVBQTJEO0FBQUEsTUFFdkRDLFVBRnVELEdBa0JyREYsS0FsQnFELENBRXZERSxVQUZ1RDtBQUFBLE1BR3ZEQyxvQkFIdUQsR0FrQnJESCxLQWxCcUQsQ0FHdkRHLG9CQUh1RDtBQUFBLE1BSXZEQyxjQUp1RCxHQWtCckRKLEtBbEJxRCxDQUl2REksY0FKdUQ7QUFBQSxNQUt2REMsUUFMdUQsR0FrQnJETCxLQWxCcUQsQ0FLdkRLLFFBTHVEO0FBQUEs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LEdBQThCLFdBQTlCO2VBRWdCSixlIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIEZhY2Vib29rLCBJbmMuIGFuZCBpdHMgYWZmaWxpYXRlcy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAZmxvdyBzdHJpY3QtbG9jYWxcbiAqIEBmb3JtYXRcbiAqL1xuXG4ndXNlIHN0cmljdCc7XG5cbmltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCB7dXNlTWVtbywgdXNlU3RhdGUsIHVzZVJlZiwgdXNlSW1wZXJhdGl2ZUhhbmRsZX0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IHVzZUFuZHJvaWRSaXBwbGVGb3JWaWV3LCB7XG4gIHR5cGUgUmlwcGxlQ29uZmlnLFxufSBmcm9tICcuL3VzZUFuZHJvaWRSaXBwbGVGb3JWaWV3JztcbmltcG9ydCB0eXBlIHtcbiAgQWNjZXNzaWJpbGl0eUFjdGlvbkV2ZW50LFxuICBBY2Nlc3NpYmlsaXR5QWN0aW9uSW5mbyxcbiAgQWNjZXNzaWJpbGl0eVJvbGUsXG4gIEFjY2Vzc2liaWxpdHlTdGF0ZSxcbiAgQWNjZXNzaWJpbGl0eVZhbHVlLFxufSBmcm9tICcuLi9WaWV3L1ZpZXdBY2Nlc3NpYmlsaXR5JztcbmltcG9ydCB7UHJlc3NhYmlsaXR5RGVidWdWaWV3fSBmcm9tICcuLi8uLi9QcmVzc2FiaWxpdHkvUHJlc3NhYmlsaXR5RGVidWcnO1xuaW1wb3J0IHVzZVByZXNzYWJpbGl0eSBmcm9tICcuLi8uLi9QcmVzc2FiaWxpdHkvdXNlUHJlc3NhYmlsaXR5JztcbmltcG9ydCB7bm9ybWFsaXplUmVjdCwgdHlwZSBSZWN0T3JTaXplfSBmcm9tICcuLi8uLi9TdHlsZVNoZWV0L1JlY3QnO1xuaW1wb3J0IHR5cGUge0NvbG9yVmFsdWV9IGZyb20gJy4uLy4uL1N0eWxlU2hlZXQvU3R5bGVTaGVldFR5cGVzJztcbmltcG9ydCB0eXBlIHtMYXlvdXRFdmVudCwgUHJlc3NFdmVudH0gZnJvbSAnLi4vLi4vVHlwZXMvQ29yZUV2ZW50VHlwZXMnO1xuaW1wb3J0IFZpZXcgZnJvbSAnLi4vVmlldy9WaWV3JztcblxudHlwZSBWaWV3U3R5bGVQcm9wID0gJEVsZW1lbnRUeXBlPFJlYWN0LkVsZW1lbnRDb25maWc8dHlwZW9mIFZpZXc+LCAnc3R5bGUnPjtcblxuZXhwb3J0IHR5cGUgU3RhdGVDYWxsYmFja1R5cGUgPSAkUmVhZE9ubHk8e3xcbiAgcHJlc3NlZDogYm9vbGVhbixcbnx9PjtcblxudHlwZSBQcm9wcyA9ICRSZWFkT25seTx7fFxuICAvKipcbiAgICogQWNjZXNzaWJpbGl0eS5cbiAgICovXG4gIGFjY2Vzc2liaWxpdHlBY3Rpb25zPzogPyRSZWFkT25seUFycmF5PEFjY2Vzc2liaWxpdHlBY3Rpb25JbmZvPixcbiAgYWNjZXNzaWJpbGl0eUVsZW1lbnRzSGlkZGVuPzogP2Jvb2xlYW4sXG4gIGFjY2Vzc2liaWxpdHlIaW50PzogP1N0cmluZ2lzaCxcbiAgYWNjZXNzaWJpbGl0eUlnbm9yZXNJbnZlcnRDb2xvcnM/OiA/Ym9vbGVhbixcbiAgYWNjZXNzaWJpbGl0eUxhYmVsPzogP1N0cmluZ2lzaCxcbiAgYWNjZXNzaWJpbGl0eUxpdmVSZWdpb24/OiA/KCdub25lJyB8ICdwb2xpdGUnIHwgJ2Fzc2VydGl2ZScpLFxuICBhY2Nlc3NpYmlsaXR5Um9sZT86ID9BY2Nlc3NpYmlsaXR5Um9sZSxcbiAgYWNjZXNzaWJpbGl0eVN0YXRlPzogP0FjY2Vzc2liaWxpdHlTdGF0ZSxcbiAgYWNjZXNzaWJpbGl0eVZhbHVlPzogP0FjY2Vzc2liaWxpdHlWYWx1ZSxcbiAgYWNjZXNzaWJpbGl0eVZpZXdJc01vZGFsPzogP2Jvb2xlYW4sXG4gIGFjY2Vzc2libGU/OiA/Ym9vbGVhbixcbiAgZm9jdXNhYmxlPzogP2Jvb2xlYW4sXG4gIGltcG9ydGFudEZvckFjY2Vzc2liaWxpdHk/OiA/KCdhdXRvJyB8ICd5ZXMnIHwgJ25vJyB8ICduby1oaWRlLWRlc2NlbmRhbnRzJyksXG4gIG9uQWNjZXNzaWJpbGl0eUFjdGlvbj86ID8oZXZlbnQ6IEFjY2Vzc2liaWxpdHlBY3Rpb25FdmVudCkgPT4gbWl4ZWQsXG5cbiAgLyoqXG4gICAqIEVpdGhlciBjaGlsZHJlbiBvciBhIHJlbmRlciBwcm9wIHRoYXQgcmVjZWl2ZXMgYSBib29sZWFuIHJlZmxlY3Rpbmcgd2hldGhlclxuICAgKiB0aGUgY29tcG9uZW50IGlzIGN1cnJlbnRseSBwcmVzc2VkLlxuICAgKi9cbiAgY2hpbGRyZW46IFJlYWN0Lk5vZGUgfCAoKHN0YXRlOiBTdGF0ZUNhbGxiYWNrVHlwZSkgPT4gUmVhY3QuTm9kZSksXG5cbiAgLyoqXG4gICAqIER1cmF0aW9uIChpbiBtaWxsaXNlY29uZHMpIGZyb20gYG9uUHJlc3NJbmAgYmVmb3JlIGBvbkxvbmdQcmVzc2AgaXMgY2FsbGVkLlxuICAgKi9cbiAgZGVsYXlMb25nUHJlc3M/OiA/bnVtYmVyLFxuXG4gIC8qKlxuICAgKiBXaGV0aGVyIHRoZSBwcmVzcyBiZWhhdmlvciBpcyBkaXNhYmxlZC5cbiAgICovXG4gIGRpc2FibGVkPzogP2Jvb2xlYW4sXG5cbiAgLyoqXG4gICAqIEFkZGl0aW9uYWwgZGlzdGFuY2Ugb3V0c2lkZSBvZiB0aGlzIHZpZXcgaW4gd2hpY2ggYSBwcmVzcyBpcyBkZXRlY3RlZC5cbiAgICovXG4gIGhpdFNsb3A/OiA/UmVjdE9yU2l6ZSxcblxuICAvKipcbiAgICogQWRkaXRpb25hbCBkaXN0YW5jZSBvdXRzaWRlIG9mIHRoaXMgdmlldyBpbiB3aGljaCBhIHRvdWNoIGlzIGNvbnNpZGVyZWQgYVxuICAgKiBwcmVzcyBiZWZvcmUgYG9uUHJlc3NPdXRgIGlzIHRyaWdnZXJlZC5cbiAgICovXG4gIHByZXNzUmV0ZW50aW9uT2Zmc2V0PzogP1JlY3RPclNpemUsXG5cbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIHRoaXMgdmlldydzIGxheW91dCBjaGFuZ2VzLlxuICAgKi9cbiAgb25MYXlvdXQ/OiA/KGV2ZW50OiBMYXlvdXRFdmVudCkgPT4gdm9pZCxcblxuICAvKipcbiAgICogQ2FsbGVkIHdoZW4gYSBsb25nLXRhcCBnZXN0dXJlIGlzIGRldGVjdGVkLlxuICAgKi9cbiAgb25Mb25nUHJlc3M/OiA/KGV2ZW50OiBQcmVzc0V2ZW50KSA9PiB2b2lkLFxuXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiBhIHNpbmdsZSB0YXAgZ2VzdHVyZSBpcyBkZXRlY3RlZC5cbiAgICovXG4gIG9uUHJlc3M/OiA/KGV2ZW50OiBQcmVzc0V2ZW50KSA9PiB2b2lkLFxuXG4gIC8qKlxuICAgKiBDYWxsZWQgd2hlbiBhIHRvdWNoIGlzIGVuZ2FnZWQgYmVmb3JlIGBvblByZXNzYC5cbiAgICovXG4gIG9uUHJlc3NJbj86ID8oZXZlbnQ6IFByZXNzRXZlbnQpID0+IHZvaWQsXG5cbiAgLyoqXG4gICAqIENhbGxlZCB3aGVuIGEgdG91Y2ggaXMgcmVsZWFzZWQgYmVmb3JlIGBvblByZXNzYC5cbiAgICovXG4gIG9uUHJlc3NPdXQ/OiA/KGV2ZW50OiBQcmVzc0V2ZW50KSA9PiB2b2lkLFxuXG4gIC8qKlxuICAgKiBFaXRoZXIgdmlldyBzdHlsZXMgb3IgYSBmdW5jdGlvbiB0aGF0IHJlY2VpdmVzIGEgYm9vbGVhbiByZWZsZWN0aW5nIHdoZXRoZXJcbiAgICogdGhlIGNvbXBvbmVudCBpcyBjdXJyZW50bHkgcHJlc3NlZCBhbmQgcmV0dXJucyB2aWV3IHN0eWxlcy5cbiAgICovXG4gIHN0eWxlPzogVmlld1N0eWxlUHJvcCB8ICgoc3RhdGU6IFN0YXRlQ2FsbGJhY2tUeXBlKSA9PiBWaWV3U3R5bGVQcm9wKSxcblxuICAvKipcbiAgICogSWRlbnRpZmllciB1c2VkIHRvIGZpbmQgdGhpcyB2aWV3IGluIHRlc3RzLlxuICAgKi9cbiAgdGVzdElEPzogP3N0cmluZyxcblxuICAvKipcbiAgICogSWYgdHJ1ZSwgZG9lc24ndCBwbGF5IHN5c3RlbSBzb3VuZCBvbiB0b3VjaC5cbiAgICovXG4gIGFuZHJvaWRfZGlzYWJsZVNvdW5kPzogP2Jvb2xlYW4sXG5cbiAgLyoqXG4gICAqIEVuYWJsZXMgdGhlIEFuZHJvaWQgcmlwcGxlIGVmZmVjdCBhbmQgY29uZmlndXJlcyBpdHMgY29sb3IuXG4gICAqL1xuICBhbmRyb2lkX3JpcHBsZT86ID9SaXBwbGVDb25maWcsXG5cbiAgLyoqXG4gICAqIFVzZWQgb25seSBmb3IgZG9jdW1lbnRhdGlvbiBvciB0ZXN0aW5nIChlLmcuIHNuYXBzaG90IHRlc3RpbmcpLlxuICAgKi9cbiAgdGVzdE9ubHlfcHJlc3NlZD86ID9ib29sZWFuLFxuXG4gIC8qKlxuICAgKiBEdXJhdGlvbiB0byB3YWl0IGFmdGVyIHByZXNzIGRvd24gYmVmb3JlIGNhbGxpbmcgYG9uUHJlc3NJbmAuXG4gICAqL1xuICB1bnN0YWJsZV9wcmVzc0RlbGF5PzogP251bWJlcixcbnx9PjtcblxuLyoqXG4gKiBDb21wb25lbnQgdXNlZCB0byBidWlsZCBkaXNwbGF5IGNvbXBvbmVudHMgdGhhdCBzaG91bGQgcmVzcG9uZCB0byB3aGV0aGVyIHRoZVxuICogY29tcG9uZW50IGlzIGN1cnJlbnRseSBwcmVzc2VkIG9yIG5vdC5cbiAqL1xuZnVuY3Rpb24gUHJlc3NhYmxlKHByb3BzOiBQcm9wcywgZm9yd2FyZGVkUmVmKTogUmVhY3QuTm9kZSB7XG4gIGNvbnN0IHtcbiAgICBhY2Nlc3NpYmxlLFxuICAgIGFuZHJvaWRfZGlzYWJsZVNvdW5kLFxuICAgIGFuZHJvaWRfcmlwcGxlLFxuICAgIGNoaWxkcmVuLFxuICAgIGRlbGF5TG9uZ1ByZXNzLFxuICAgIGRpc2FibGVkLFxuICAgIGZvY3VzYWJsZSxcbiAgICBvbkxvbmdQcmVzcyxcbiAgICBvblByZXNzLFxuICAgIG9uUHJlc3NJbixcbiAgICBvblByZXNzT3V0LFxuICAgIHByZXNzUmV0ZW50aW9uT2Zmc2V0LFxuICAgIHN0eWxlLFxuICAgIHRlc3RPbmx5X3ByZXNzZWQsXG4gICAgdW5zdGFibGVfcHJlc3NEZWxheSxcbiAgICAuLi5yZXN0UHJvcHNcbiAgfSA9IHByb3BzO1xuXG4gIGNvbnN0IHZpZXdSZWYgPSB1c2VSZWY8UmVhY3QuRWxlbWVudFJlZjx0eXBlb2YgVmlldz4gfCBudWxsPihudWxsKTtcbiAgdXNlSW1wZXJhdGl2ZUhhbmRsZShmb3J3YXJkZWRSZWYsICgpID0+IHZpZXdSZWYuY3VycmVudCk7XG5cbiAgY29uc3QgYW5kcm9pZF9yaXBwbGVDb25maWcgPSB1c2VBbmRyb2lkUmlwcGxlRm9yVmlldyhhbmRyb2lkX3JpcHBsZSwgdmlld1JlZik7XG5cbiAgY29uc3QgW3ByZXNzZWQsIHNldFByZXNzZWRdID0gdXNlUHJlc3NTdGF0ZSh0ZXN0T25seV9wcmVzc2VkID09PSB0cnVlKTtcblxuICBjb25zdCBoaXRTbG9wID0gbm9ybWFsaXplUmVjdChwcm9wcy5oaXRTbG9wKTtcblxuICBjb25zdCBjb25maWcgPSB1c2VNZW1vKFxuICAgICgpID0+ICh7XG4gICAgICBkaXNhYmxlZCxcbiAgICAgIGhpdFNsb3AsXG4gICAgICBwcmVzc1JlY3RPZmZzZXQ6IHByZXNzUmV0ZW50aW9uT2Zmc2V0LFxuICAgICAgYW5kcm9pZF9kaXNhYmxlU291bmQsXG4gICAgICBkZWxheUxvbmdQcmVzcyxcbiAgICAgIGRlbGF5UHJlc3NJbjogdW5zdGFibGVfcHJlc3NEZWxheSxcbiAgICAgIG9uTG9uZ1ByZXNzLFxuICAgICAgb25QcmVzcyxcbiAgICAgIG9uUHJlc3NJbihldmVudDogUHJlc3NFdmVudCk6IHZvaWQge1xuICAgICAgICBpZiAoYW5kcm9pZF9yaXBwbGVDb25maWcgIT0gbnVsbCkge1xuICAgICAgICAgIGFuZHJvaWRfcmlwcGxlQ29uZmlnLm9uUHJlc3NJbihldmVudCk7XG4gICAgICAgIH1cbiAgICAgICAgc2V0UHJlc3NlZCh0cnVlKTtcbiAgICAgICAgaWYgKG9uUHJlc3NJbiAhPSBudWxsKSB7XG4gICAgICAgICAgb25QcmVzc0luKGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG9uUHJlc3NNb3ZlOiBhbmRyb2lkX3JpcHBsZUNvbmZpZz8ub25QcmVzc01vdmUsXG4gICAgICBvblByZXNzT3V0KGV2ZW50OiBQcmVzc0V2ZW50KTogdm9pZCB7XG4gICAgICAgIGlmIChhbmRyb2lkX3JpcHBsZUNvbmZpZyAhPSBudWxsKSB7XG4gICAgICAgICAgYW5kcm9pZF9yaXBwbGVDb25maWcub25QcmVzc091dChldmVudCk7XG4gICAgICAgIH1cbiAgICAgICAgc2V0UHJlc3NlZChmYWxzZSk7XG4gICAgICAgIGlmIChvblByZXNzT3V0ICE9IG51bGwpIHtcbiAgICAgICAgICBvblByZXNzT3V0KGV2ZW50KTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICB9KSxcbiAgICBbXG4gICAgICBhbmRyb2lkX2Rpc2FibGVTb3VuZCxcbiAgICAgIGFuZHJvaWRfcmlwcGxlQ29uZmlnLFxuICAgICAgZGVsYXlMb25nUHJlc3MsXG4gICAgICBkaXNhYmxlZCxcbiAgICAgIGhpdFNsb3AsXG4gICAgICBvbkxvbmdQcmVzcyxcbiAgICAgIG9uUHJlc3MsXG4gICAgICBvblByZXNzSW4sXG4gICAgICBvblByZXNzT3V0LFxuICAgICAgcHJlc3NSZXRlbnRpb25PZmZzZXQsXG4gICAgICBzZXRQcmVzc2VkLFxuICAgICAgdW5zdGFibGVfcHJlc3NEZWxheSxcbiAgICBdLFxuICApO1xuICBjb25zdCBldmVudEhhbmRsZXJzID0gdXNlUHJlc3NhYmlsaXR5KGNvbmZpZyk7XG5cbiAgcmV0dXJuIChcbiAgICA8Vmlld1xuICAgICAgey4uLnJlc3RQcm9wc31cbiAgICAgIHsuLi5ldmVudEhhbmRsZXJzfVxuICAgICAgey4uLmFuZHJvaWRfcmlwcGxlQ29uZmlnPy52aWV3UHJvcHN9XG4gICAgICBhY2Nlc3NpYmxlPXthY2Nlc3NpYmxlICE9PSBmYWxzZX1cbiAgICAgIGZvY3VzYWJsZT17Zm9jdXNhYmxlICE9PSBmYWxzZX1cbiAgICAgIGhpdFNsb3A9e2hpdFNsb3B9XG4gICAgICByZWY9e3ZpZXdSZWZ9XG4gICAgICBzdHlsZT17dHlwZW9mIHN0eWxlID09PSAnZnVuY3Rpb24nID8gc3R5bGUoe3ByZXNzZWR9KSA6IHN0eWxlfT5cbiAgICAgIHt0eXBlb2YgY2hpbGRyZW4gPT09ICdmdW5jdGlvbicgPyBjaGlsZHJlbih7cHJlc3NlZH0pIDogY2hpbGRyZW59XG4gICAgICB7X19ERVZfXyA/IDxQcmVzc2FiaWxpdHlEZWJ1Z1ZpZXcgY29sb3I9XCJyZWRcIiBoaXRTbG9wPXtoaXRTbG9wfSAvPiA6IG51bGx9XG4gICAgPC9WaWV3PlxuICApO1xufVxuXG5mdW5jdGlvbiB1c2VQcmVzc1N0YXRlKGZvcmNlUHJlc3NlZDogYm9vbGVhbik6IFtib29sZWFuLCAoYm9vbGVhbikgPT4gdm9pZF0ge1xuICBjb25zdCBbcHJlc3NlZCwgc2V0UHJlc3NlZF0gPSB1c2VTdGF0ZShmYWxzZSk7XG4gIHJldHVybiBbcHJlc3NlZCB8fCBmb3JjZVByZXNzZWQsIHNldFByZXNzZWRdO1xufVxuXG5jb25zdCBNZW1vZWRQcmVzc2FibGUgPSBSZWFjdC5tZW1vKFJlYWN0LmZvcndhcmRSZWYoUHJlc3NhYmxlKSk7XG5NZW1vZWRQcmVzc2FibGUuZGlzcGxheU5hbWUgPSAnUHJlc3NhYmxlJztcblxuZXhwb3J0IGRlZmF1bHQgKE1lbW9lZFByZXNzYWJsZTogUmVhY3QuQWJzdHJhY3RDb21wb25lbnQ8XG4gIFByb3BzLFxuICBSZWFjdC5FbGVtZW50UmVmPHR5cGVvZiBWaWV3Pixcbj4pO1xuIl19