7296f90d0e8546d48e527e1d15e0ef71
"use strict";

var _interopRequireDefault2 = require("@babel/runtime/helpers/interopRequireDefault");

var _defineProperty2 = _interopRequireDefault2(require("@babel/runtime/helpers/defineProperty"));

var _extends4 = _interopRequireDefault2(require("@babel/runtime/helpers/extends"));

var _toConsumableArray2 = _interopRequireDefault2(require("@babel/runtime/helpers/toConsumableArray"));

var _slicedToArray2 = _interopRequireDefault2(require("@babel/runtime/helpers/slicedToArray"));

function _createForOfIteratorHelperLoose(o, allowArrayLike) { var it; if (typeof Symbol === "undefined" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; return function () { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } it = o[Symbol.iterator](); return it.next.bind(it); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = getStateFromPath;

var _escapeStringRegexp = _interopRequireDefault(require("escape-string-regexp"));

var queryString = _interopRequireWildcard(require("query-string"));

var _checkLegacyPathConfig = _interopRequireDefault(require("./checkLegacyPathConfig"));

function _getRequireWildcardCache() {
  if (typeof WeakMap !== "function") return null;
  var cache = new WeakMap();

  _getRequireWildcardCache = function _getRequireWildcardCache() {
    return cache;
  };

  return cache;
}

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  }

  if (obj === null || typeof obj !== "object" && typeof obj !== "function") {
    return {
      default: obj
    };
  }

  var cache = _getRequireWildcardCache();

  if (cache && cache.has(obj)) {
    return cache.get(obj);
  }

  var newObj = {};
  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;

  for (var key in obj) {
    if (Object.prototype.hasOwnProperty.call(obj, key)) {
      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;

      if (desc && (desc.get || desc.set)) {
        Object.defineProperty(newObj, key, desc);
      } else {
        newObj[key] = obj[key];
      }
    }
  }

  newObj.default = obj;

  if (cache) {
    cache.set(obj, newObj);
  }

  return newObj;
}

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {
    default: obj
  };
}

function getStateFromPath(path, options) {
  var _ref3;

  var _ref = (0, _checkLegacyPathConfig.default)(options),
      _ref2 = (0, _slicedToArray2.default)(_ref, 2),
      legacy = _ref2[0],
      compatOptions = _ref2[1];

  var initialRoutes = [];

  if (compatOptions !== null && compatOptions !== void 0 && compatOptions.initialRouteName) {
    initialRoutes.push({
      initialRouteName: compatOptions.initialRouteName,
      connectedRoutes: Object.keys(compatOptions.screens)
    });
  }

  var screens = compatOptions === null || compatOptions === void 0 ? void 0 : compatOptions.screens;
  var remaining = path.replace(/\/+/g, '/').replace(/^\//, '').replace(/\?.*$/, '');
  remaining = remaining.endsWith('/') ? remaining : "".concat(remaining, "/");

  if (screens === undefined) {
    var routes = remaining.split('/').filter(Boolean).map(function (segment, i, self) {
      var name = decodeURIComponent(segment);

      if (i === self.length - 1) {
        return {
          name: name,
          params: parseQueryParams(path)
        };
      }

      return {
        name: name
      };
    });

    if (routes.length) {
      return createNestedStateObject(routes, initialRoutes);
    }

    return undefined;
  }

  var configs = (_ref3 = []).concat.apply(_ref3, (0, _toConsumableArray2.default)(Object.keys(screens).map(function (key) {
    return createNormalizedConfigs(legacy, key, screens, [], initialRoutes);
  }))).sort(function (a, b) {
    if (a.pattern === b.pattern) {
      return b.routeNames.join('>').localeCompare(a.routeNames.join('>'));
    }

    if (a.pattern.startsWith(b.pattern)) {
      return -1;
    }

    if (b.pattern.startsWith(a.pattern)) {
      return 1;
    }

    var aParts = a.pattern.split('/');
    var bParts = b.pattern.split('/');
    var aWildcardIndex = aParts.indexOf('*');
    var bWildcardIndex = bParts.indexOf('*');

    if (aWildcardIndex === -1 && bWildcardIndex !== -1) {
      return -1;
    }

    if (aWildcardIndex !== -1 && bWildcardIndex === -1) {
      return 1;
    }

    if (aWildcardIndex === bWildcardIndex) {
      return bParts.length - aParts.length;
    }

    return bWildcardIndex - aWildcardIndex;
  });

  configs.reduce(function (acc, config) {
    if (acc[config.pattern]) {
      var a = acc[config.pattern].routeNames;
      var b = config.routeNames;
      var intersects = a.length > b.length ? b.every(function (it, i) {
        return a[i] === it;
      }) : a.every(function (it, i) {
        return b[i] === it;
      });

      if (!intersects) {
        throw new Error("Found conflicting screens with the same pattern. The pattern '".concat(config.pattern, "' resolves to both '").concat(a.join(' > '), "' and '").concat(b.join(' > '), "'. Patterns must be unique and cannot resolve to more than one screen."));
      }
    }

    return (0, _extends4.default)(acc, (0, _defineProperty2.default)({}, config.pattern, config));
  }, {});

  if (remaining === '/') {
    var match = configs.find(function (config) {
      return config.path === '' && config.routeNames.every(function (name) {
        var _configs$find;

        return !((_configs$find = configs.find(function (c) {
          return c.screen === name;
        })) !== null && _configs$find !== void 0 && _configs$find.path);
      });
    });

    if (match) {
      return createNestedStateObject(match.routeNames.map(function (name, i, self) {
        if (i === self.length - 1) {
          return {
            name: name,
            params: parseQueryParams(path, match.parse)
          };
        }

        return {
          name: name
        };
      }), initialRoutes);
    }

    return undefined;
  }

  var result;
  var current;

  if (legacy === false) {
    var _matchAgainstConfigs = matchAgainstConfigs(remaining, configs.map(function (c) {
      return _objectSpread(_objectSpread({}, c), {}, {
        regex: c.regex ? new RegExp(c.regex.source + '$') : undefined
      });
    })),
        _routes = _matchAgainstConfigs.routes,
        remainingPath = _matchAgainstConfigs.remainingPath;

    if (_routes !== undefined) {
      current = createNestedStateObject(_routes, initialRoutes);
      remaining = remainingPath;
      result = current;
    }
  } else {
    while (remaining) {
      var _matchAgainstConfigs2 = matchAgainstConfigs(remaining, configs),
          _routes2 = _matchAgainstConfigs2.routes,
          _remainingPath = _matchAgainstConfigs2.remainingPath;

      remaining = _remainingPath;

      if (_routes2 === undefined) {
        var segments = remaining.split('/');
        _routes2 = [{
          name: decodeURIComponent(segments[0])
        }];
        segments.shift();
        remaining = segments.join('/');
      }

      var state = createNestedStateObject(_routes2, initialRoutes);

      if (current) {
        var _current2;

        while ((_current = current) !== null && _current !== void 0 && _current.routes[current.index || 0].state) {
          var _current;

          current = current.routes[current.index || 0].state;
        }

        current.routes[((_current2 = current) === null || _current2 === void 0 ? void 0 : _current2.index) || 0].state = state;
      } else {
        result = state;
      }

      current = state;
    }
  }

  if (current == null || result == null) {
    return undefined;
  }

  var route = findFocusedRoute(current);
  var params = parseQueryParams(path, findParseConfigForRoute(route.name, configs));

  if (params) {
    route.params = _objectSpread(_objectSpread({}, route.params), params);
  }

  return result;
}

var joinPaths = function joinPaths() {
  var _ref4;

  for (var _len = arguments.length, paths = new Array(_len), _key = 0; _key < _len; _key++) {
    paths[_key] = arguments[_key];
  }

  return (_ref4 = []).concat.apply(_ref4, (0, _toConsumableArray2.default)(paths.map(function (p) {
    return p.split('/');
  }))).filter(Boolean).join('/');
};

var matchAgainstConfigs = function matchAgainstConfigs(remaining, configs) {
  var routes;
  var remainingPath = remaining;

  var _loop = function _loop(config) {
    if (!config.regex) {
      return "continue";
    }

    var match = remainingPath.match(config.regex);

    if (match) {
      var matchedParams = (_config$pattern = config.pattern) === null || _config$pattern === void 0 ? void 0 : _config$pattern.split('/').filter(function (p) {
        return p.startsWith(':');
      }).reduce(function (acc, p, i) {
        return (0, _extends4.default)(acc, (0, _defineProperty2.default)({}, p, match[(i + 1) * 2].replace(/\//, '')));
      }, {});
      routes = config.routeNames.map(function (name) {
        var _config$path;

        var config = configs.find(function (c) {
          return c.screen === name;
        });
        var params = config === null || config === void 0 ? void 0 : (_config$path = config.path) === null || _config$path === void 0 ? void 0 : _config$path.split('/').filter(function (p) {
          return p.startsWith(':');
        }).reduce(function (acc, p) {
          var value = matchedParams[p];

          if (value) {
            var _config$parse;

            var key = p.replace(/^:/, '').replace(/\?$/, '');
            acc[key] = (_config$parse = config.parse) !== null && _config$parse !== void 0 && _config$parse[key] ? config.parse[key](value) : value;
          }

          return acc;
        }, {});

        if (params && Object.keys(params).length) {
          return {
            name: name,
            params: params
          };
        }

        return {
          name: name
        };
      });
      remainingPath = remainingPath.replace(match[1], '');
      return "break";
    }
  };

  for (var _iterator = _createForOfIteratorHelperLoose(configs), _step; !(_step = _iterator()).done;) {
    var config = _step.value;

    var _config$pattern;

    var _ret = _loop(config);

    if (_ret === "continue") continue;
    if (_ret === "break") break;
  }

  return {
    routes: routes,
    remainingPath: remainingPath
  };
};

var createNormalizedConfigs = function createNormalizedConfigs(legacy, screen, routeConfig) {
  var routeNames = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : [];
  var initials = arguments.length > 4 ? arguments[4] : undefined;
  var parentPattern = arguments.length > 5 ? arguments[5] : undefined;
  var configs = [];
  routeNames.push(screen);
  var config = routeConfig[screen];

  if (typeof config === 'string') {
    var pattern = parentPattern ? joinPaths(parentPattern, config) : config;
    configs.push(createConfigItem(legacy, screen, routeNames, pattern, config));
  } else if (typeof config === 'object') {
    var _pattern2;

    if (typeof config.path === 'string') {
      if (legacy) {
        _pattern2 = config.exact !== true && parentPattern ? joinPaths(parentPattern, config.path) : config.path;
      } else {
        if (config.exact && config.path === undefined) {
          throw new Error("A 'path' needs to be specified when specifying 'exact: true'. If you don't want this screen in the URL, specify it as empty string, e.g. `path: ''`.");
        }

        _pattern2 = config.exact !== true ? joinPaths(parentPattern || '', config.path || '') : config.path || '';
      }

      configs.push(createConfigItem(legacy, screen, routeNames, _pattern2, config.path, config.parse));
    }

    if (config.screens) {
      if (config.initialRouteName) {
        initials.push({
          initialRouteName: config.initialRouteName,
          connectedRoutes: Object.keys(config.screens)
        });
      }

      Object.keys(config.screens).forEach(function (nestedConfig) {
        var _pattern;

        var result = createNormalizedConfigs(legacy, nestedConfig, config.screens, routeNames, initials, (_pattern = _pattern2) !== null && _pattern !== void 0 ? _pattern : parentPattern);
        configs.push.apply(configs, (0, _toConsumableArray2.default)(result));
      });
    }
  }

  routeNames.pop();
  return configs;
};

var createConfigItem = function createConfigItem(legacy, screen, routeNames, pattern, path, parse) {
  pattern = pattern.split('/').filter(Boolean).join('/');
  var regex = pattern ? new RegExp("^(".concat(pattern.split('/').map(function (it) {
    if (legacy && it === '*') {
      throw new Error("Please update your config to the new format to use wildcard pattern ('*'). https://reactnavigation.org/docs/configuring-links/#updating-config");
    }

    if (it.startsWith(':')) {
      return "(([^/]+\\/)".concat(it.endsWith('?') ? '?' : '', ")");
    }

    return "".concat(it === '*' ? '.*' : (0, _escapeStringRegexp.default)(it), "\\/");
  }).join(''), ")")) : undefined;
  return {
    screen: screen,
    regex: regex,
    pattern: pattern,
    path: path,
    routeNames: (0, _toConsumableArray2.default)(routeNames),
    parse: parse
  };
};

var findParseConfigForRoute = function findParseConfigForRoute(routeName, flatConfig) {
  for (var _iterator2 = _createForOfIteratorHelperLoose(flatConfig), _step2; !(_step2 = _iterator2()).done;) {
    var config = _step2.value;

    if (routeName === config.routeNames[config.routeNames.length - 1]) {
      return config.parse;
    }
  }

  return undefined;
};

var findInitialRoute = function findInitialRoute(routeName, initialRoutes) {
  for (var _iterator3 = _createForOfIteratorHelperLoose(initialRoutes), _step3; !(_step3 = _iterator3()).done;) {
    var config = _step3.value;

    if (config.connectedRoutes.includes(routeName)) {
      return config.initialRouteName === routeName ? undefined : config.initialRouteName;
    }
  }

  return undefined;
};

var createStateObject = function createStateObject(initialRoute, route, isEmpty) {
  if (isEmpty) {
    if (initialRoute) {
      return {
        index: 1,
        routes: [{
          name: initialRoute
        }, route]
      };
    } else {
      return {
        routes: [route]
      };
    }
  } else {
    if (initialRoute) {
      return {
        index: 1,
        routes: [{
          name: initialRoute
        }, _objectSpread(_objectSpread({}, route), {}, {
          state: {
            routes: []
          }
        })]
      };
    } else {
      return {
        routes: [_objectSpread(_objectSpread({}, route), {}, {
          state: {
            routes: []
          }
        })]
      };
    }
  }
};

var createNestedStateObject = function createNestedStateObject(routes, initialRoutes) {
  var state;
  var route = routes.shift();
  var initialRoute = findInitialRoute(route.name, initialRoutes);
  state = createStateObject(initialRoute, route, routes.length === 0);

  if (routes.length > 0) {
    var nestedState = state;

    while (route = routes.shift()) {
      initialRoute = findInitialRoute(route.name, initialRoutes);
      var nestedStateIndex = nestedState.index || nestedState.routes.length - 1;
      nestedState.routes[nestedStateIndex].state = createStateObject(initialRoute, route, routes.length === 0);

      if (routes.length > 0) {
        nestedState = nestedState.routes[nestedStateIndex].state;
      }
    }
  }

  return state;
};

var findFocusedRoute = function findFocusedRoute(state) {
  var _current4;

  var current = state;

  while ((_current3 = current) !== null && _current3 !== void 0 && _current3.routes[current.index || 0].state) {
    var _current3;

    current = current.routes[current.index || 0].state;
  }

  var route = current.routes[((_current4 = current) === null || _current4 === void 0 ? void 0 : _current4.index) || 0];
  return route;
};

var parseQueryParams = function parseQueryParams(path, parseConfig) {
  var query = path.split('?')[1];
  var params = queryString.parse(query);

  if (parseConfig) {
    Object.keys(params).forEach(function (name) {
      if (parseConfig[name] && typeof params[name] === 'string') {
        params[name] = parseConfig[name](params[name]);
      }
    });
  }

  return Object.keys(params).length ? params : undefined;
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImdldFN0YXRlRnJvbVBhdGgudHN4Il0sIm5hbWVzIjpbImluaXRpYWxSb3V0ZXMiLCJjb21wYXRPcHRpb25zIiwiaW5pdGlhbFJvdXRlTmFtZSIsImNvbm5lY3RlZFJvdXRlcyIsIk9iamVjdCIsInNjcmVlbnMiLCJyZW1haW5pbmciLCJyb3V0ZXMiLCJuYW1lIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwiaSIsInNlbGYiLCJwYXJhbXMiLCJwYXJzZVF1ZXJ5UGFyYW1zIiwiY3JlYXRlTmVzdGVkU3RhdGVPYmplY3QiLCJjb25maWdzIiwia2V5IiwiY3JlYXRlTm9ybWFsaXplZENvbmZpZ3MiLCJhIiwiYiIsImFQYXJ0cyIsImJQYXJ0cyIsImFXaWxkY2FyZEluZGV4IiwiYldpbGRjYXJkSW5kZXgiLCJhY2MiLCJjb25maWciLCJpbnRlcnNlY3RzIiwibWF0Y2giLCJjIiwibGVnYWN5IiwicmVtYWluaW5nUGF0aCIsIm1hdGNoQWdhaW5zdENvbmZpZ3MiLCJyZWdleCIsInVuZGVmaW5lZCIsImN1cnJlbnQiLCJyZXN1bHQiLCJzZWdtZW50cyIsInN0YXRlIiwicm91dGUiLCJmaW5kRm9jdXNlZFJvdXRlIiwiZmluZFBhcnNlQ29uZmlnRm9yUm91dGUiLCJqb2luUGF0aHMiLCJwYXRocyIsInAiLCJtYXRjaGVkUGFyYW1zIiwidmFsdWUiLCJyb3V0ZU5hbWVzIiwicm91dGVDb25maWciLCJwYXR0ZXJuIiwicGFyZW50UGF0dGVybiIsImNyZWF0ZUNvbmZpZ0l0ZW0iLCJpbml0aWFscyIsIm5lc3RlZENvbmZpZyIsIml0Iiwic2NyZWVuIiwicGF0aCIsInBhcnNlIiwicm91dGVOYW1lIiwiZmluZEluaXRpYWxSb3V0ZSIsImNyZWF0ZVN0YXRlT2JqZWN0IiwiaW5kZXgiLCJpbml0aWFsUm91dGUiLCJuZXN0ZWRTdGF0ZSIsIm5lc3RlZFN0YXRlSW5kZXgiLCJxdWVyeSIsInF1ZXJ5U3RyaW5nIiwicGFyc2VDb25maWciXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7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QVU7QUFDcEMsVUFBSTBELFdBQVcsQ0FBWEEsSUFBVyxDQUFYQSxJQUFxQixPQUFPdEQsTUFBTSxDQUFiLElBQWEsQ0FBYixLQUF6QixRQUFBLEVBQTJEO0FBQ3pEQSxRQUFBQSxNQUFNLENBQU5BLElBQU0sQ0FBTkEsR0FBZXNELFdBQVcsQ0FBWEEsSUFBVyxDQUFYQSxDQUFrQnRELE1BQU0sQ0FBdkNBLElBQXVDLENBQXhCc0QsQ0FBZnREO0FBQ0Q7QUFISFIsS0FBQUE7QUFLRDs7QUFFRCxTQUFPQSxNQUFNLENBQU5BLElBQUFBLENBQUFBLE1BQUFBLEVBQUFBLE1BQUFBLEdBQUFBLE1BQUFBLEdBQVAsU0FBQTtBQWZGLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZXNjYXBlIGZyb20gJ2VzY2FwZS1zdHJpbmctcmVnZXhwJztcbmltcG9ydCAqIGFzIHF1ZXJ5U3RyaW5nIGZyb20gJ3F1ZXJ5LXN0cmluZyc7XG5pbXBvcnQgdHlwZSB7XG4gIE5hdmlnYXRpb25TdGF0ZSxcbiAgUGFydGlhbFN0YXRlLFxuICBJbml0aWFsU3RhdGUsXG59IGZyb20gJ0ByZWFjdC1uYXZpZ2F0aW9uL3JvdXRlcnMnO1xuaW1wb3J0IGNoZWNrTGVnYWN5UGF0aENvbmZpZyBmcm9tICcuL2NoZWNrTGVnYWN5UGF0aENvbmZpZyc7XG5pbXBvcnQgdHlwZSB7IFBhdGhDb25maWdNYXAgfSBmcm9tICcuL3R5cGVzJztcblxudHlwZSBPcHRpb25zID0ge1xuICBpbml0aWFsUm91dGVOYW1lPzogc3RyaW5nO1xuICBzY3JlZW5zOiBQYXRoQ29uZmlnTWFwO1xufTtcblxudHlwZSBQYXJzZUNvbmZpZyA9IFJlY29yZDxzdHJpbmcsICh2YWx1ZTogc3RyaW5nKSA9PiBhbnk+O1xuXG50eXBlIFJvdXRlQ29uZmlnID0ge1xuICBzY3JlZW46IHN0cmluZztcbiAgcmVnZXg/OiBSZWdFeHA7XG4gIHBhdGg6IHN0cmluZztcbiAgcGF0dGVybjogc3RyaW5nO1xuICByb3V0ZU5hbWVzOiBzdHJpbmdbXTtcbiAgcGFyc2U/OiBQYXJzZUNvbmZpZztcbn07XG5cbnR5cGUgSW5pdGlhbFJvdXRlQ29uZmlnID0ge1xuICBpbml0aWFsUm91dGVOYW1lOiBzdHJpbmc7XG4gIGNvbm5lY3RlZFJvdXRlczogc3RyaW5nW107XG59O1xuXG50eXBlIFJlc3VsdFN0YXRlID0gUGFydGlhbFN0YXRlPE5hdmlnYXRpb25TdGF0ZT4gJiB7XG4gIHN0YXRlPzogUmVzdWx0U3RhdGU7XG59O1xuXG50eXBlIFBhcnNlZFJvdXRlID0ge1xuICBuYW1lOiBzdHJpbmc7XG4gIHBhcmFtcz86IFJlY29yZDxzdHJpbmcsIGFueT4gfCB1bmRlZmluZWQ7XG59O1xuXG4vKipcbiAqIFV0aWxpdHkgdG8gcGFyc2UgYSBwYXRoIHN0cmluZyB0byBpbml0aWFsIHN0YXRlIG9iamVjdCBhY2NlcHRlZCBieSB0aGUgY29udGFpbmVyLlxuICogVGhpcyBpcyB1c2VmdWwgZm9yIGRlZXAgbGlua2luZyB3aGVuIHdlIG5lZWQgdG8gaGFuZGxlIHRoZSBpbmNvbWluZyBVUkwuXG4gKlxuICogQGV4YW1wbGVcbiAqIGBgYGpzXG4gKiBnZXRTdGF0ZUZyb21QYXRoKFxuICogICAnL2NoYXQvamFuZS80MicsXG4gKiAgIHtcbiAqICAgICBzY3JlZW5zOiB7XG4gKiAgICAgICBDaGF0OiB7XG4gKiAgICAgICAgIHBhdGg6ICdjaGF0LzphdXRob3IvOmlkJyxcbiAqICAgICAgICAgcGFyc2U6IHsgaWQ6IE51bWJlciB9XG4gKiAgICAgICB9XG4gKiAgICAgfVxuICogICB9XG4gKiApXG4gKiBgYGBcbiAqIEBwYXJhbSBwYXRoIFBhdGggc3RyaW5nIHRvIHBhcnNlIGFuZCBjb252ZXJ0LCBlLmcuIC9mb28vYmFyP2NvdW50PTQyLlxuICogQHBhcmFtIG9wdGlvbnMgRXh0cmEgb3B0aW9ucyB0byBmaW5lLXR1bmUgaG93IHRvIHBhcnNlIHRoZSBwYXRoLlxuICovXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRTdGF0ZUZyb21QYXRoKFxuICBwYXRoOiBzdHJpbmcsXG4gIG9wdGlvbnM/OiBPcHRpb25zXG4pOiBSZXN1bHRTdGF0ZSB8IHVuZGVmaW5lZCB7XG4gIGNvbnN0IFtsZWdhY3ksIGNvbXBhdE9wdGlvbnNdID0gY2hlY2tMZWdhY3lQYXRoQ29uZmlnKG9wdGlvbnMpO1xuXG4gIGxldCBpbml0aWFsUm91dGVzOiBJbml0aWFsUm91dGVDb25maWdbXSA9IFtdO1xuXG4gIGlmIChjb21wYXRPcHRpb25zPy5pbml0aWFsUm91dGVOYW1lKSB7XG4gICAgaW5pdGlhbFJvdXRlcy5wdXNoKHtcbiAgICAgIGluaXRpYWxSb3V0ZU5hbWU6IGNvbXBhdE9wdGlvbnMuaW5pdGlhbFJvdXRlTmFtZSxcbiAgICAgIGNvbm5lY3RlZFJvdXRlczogT2JqZWN0LmtleXMoY29tcGF0T3B0aW9ucy5zY3JlZW5zKSxcbiAgICB9KTtcbiAgfVxuXG4gIGNvbnN0IHNjcmVlbnMgPSBjb21wYXRPcHRpb25zPy5zY3JlZW5zO1xuXG4gIGxldCByZW1haW5pbmcgPSBwYXRoXG4gICAgLnJlcGxhY2UoL1xcLysvZywgJy8nKSAvLyBSZXBsYWNlIG11bHRpcGxlIHNsYXNoICgvLykgd2l0aCBzaW5nbGUgb25lc1xuICAgIC5yZXBsYWNlKC9eXFwvLywgJycpIC8vIFJlbW92ZSBleHRyYSBsZWFkaW5nIHNsYXNoXG4gICAgLnJlcGxhY2UoL1xcPy4qJC8sICcnKTsgLy8gUmVtb3ZlIHF1ZXJ5IHBhcmFtcyB3aGljaCB3ZSB3aWxsIGhhbmRsZSBsYXRlclxuXG4gIC8vIE1ha2Ugc3VyZSB0aGVyZSBpcyBhIHRyYWlsaW5nIHNsYXNoXG4gIHJlbWFpbmluZyA9IHJlbWFpbmluZy5lbmRzV2l0aCgnLycpID8gcmVtYWluaW5nIDogYCR7cmVtYWluaW5nfS9gO1xuXG4gIGlmIChzY3JlZW5zID09PSB1bmRlZmluZWQpIHtcbiAgICAvLyBXaGVuIG5vIGNvbmZpZyBpcyBzcGVjaWZpZWQsIHVzZSB0aGUgcGF0aCBzZWdtZW50cyBhcyByb3V0ZSBuYW1lc1xuICAgIGNvbnN0IHJvdXRlcyA9IHJlbWFpbmluZ1xuICAgICAgLnNwbGl0KCcvJylcbiAgICAgIC5maWx0ZXIoQm9vbGVhbilcbiAgICAgIC5tYXAoKHNlZ21lbnQsIGksIHNlbGYpID0+IHtcbiAgICAgICAgY29uc3QgbmFtZSA9IGRlY29kZVVSSUNvbXBvbmVudChzZWdtZW50KTtcblxuICAgICAgICBpZiAoaSA9PT0gc2VsZi5sZW5ndGggLSAxKSB7XG4gICAgICAgICAgcmV0dXJuIHsgbmFtZSwgcGFyYW1zOiBwYXJzZVF1ZXJ5UGFyYW1zKHBhdGgpIH07XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4geyBuYW1lIH07XG4gICAgICB9KTtcblxuICAgIGlmIChyb3V0ZXMubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gY3JlYXRlTmVzdGVkU3RhdGVPYmplY3Qocm91dGVzLCBpbml0aWFsUm91dGVzKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xuICB9XG5cbiAgLy8gQ3JlYXRlIGEgbm9ybWFsaXplZCBjb25maWdzIGFycmF5IHdoaWNoIHdpbGwgYmUgZWFzaWVyIHRvIHVzZVxuICBjb25zdCBjb25maWdzID0gKFtdIGFzIFJvdXRlQ29uZmlnW10pXG4gICAgLmNvbmNhdChcbiAgICAgIC4uLk9iamVjdC5rZXlzKHNjcmVlbnMpLm1hcCgoa2V5KSA9PlxuICAgICAgICBjcmVhdGVOb3JtYWxpemVkQ29uZmlncyhcbiAgICAgICAgICBsZWdhY3ksXG4gICAgICAgICAga2V5LFxuICAgICAgICAgIHNjcmVlbnMgYXMgUGF0aENvbmZpZ01hcCxcbiAgICAgICAgICBbXSxcbiAgICAgICAgICBpbml0aWFsUm91dGVzXG4gICAgICAgIClcbiAgICAgIClcbiAgICApXG4gICAgLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgIC8vIFNvcnQgY29uZmlnIHNvIHRoYXQ6XG4gICAgICAvLyAtIHRoZSBtb3N0IGV4aGF1c3RpdmUgb25lcyBhcmUgYWx3YXlzIGF0IHRoZSBiZWdpbm5pbmdcbiAgICAgIC8vIC0gcGF0dGVybnMgd2l0aCB3aWxkY2FyZCBhcmUgYWx3YXlzIGF0IHRoZSBlbmRcblxuICAgICAgLy8gSWYgMiBwYXR0ZXJucyBhcmUgc2FtZSwgbW92ZSB0aGUgb25lIHdpdGggbGVzcyByb3V0ZSBuYW1lcyB1cFxuICAgICAgLy8gVGhpcyBpcyBhbiBlcnJvciBzdGF0ZSwgc28gaXQncyBvbmx5IHVzZWZ1bCBmb3IgY29uc2lzdGVudCBlcnJvciBtZXNzYWdlc1xuICAgICAgaWYgKGEucGF0dGVybiA9PT0gYi5wYXR0ZXJuKSB7XG4gICAgICAgIHJldHVybiBiLnJvdXRlTmFtZXMuam9pbignPicpLmxvY2FsZUNvbXBhcmUoYS5yb3V0ZU5hbWVzLmpvaW4oJz4nKSk7XG4gICAgICB9XG5cbiAgICAgIC8vIElmIG9uZSBvZiB0aGUgcGF0dGVybnMgc3RhcnRzIHdpdGggdGhlIG90aGVyLCBpdCdzIG1vcmUgZXhoYXVzdGl2ZVxuICAgICAgLy8gU28gbW92ZSBpdCB1cFxuICAgICAgaWYgKGEucGF0dGVybi5zdGFydHNXaXRoKGIucGF0dGVybikpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgfVxuXG4gICAgICBpZiAoYi5wYXR0ZXJuLnN0YXJ0c1dpdGgoYS5wYXR0ZXJuKSkge1xuICAgICAgICByZXR1cm4gMTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgYVBhcnRzID0gYS5wYXR0ZXJuLnNwbGl0KCcvJyk7XG4gICAgICBjb25zdCBiUGFydHMgPSBiLnBhdHRlcm4uc3BsaXQoJy8nKTtcblxuICAgICAgY29uc3QgYVdpbGRjYXJkSW5kZXggPSBhUGFydHMuaW5kZXhPZignKicpO1xuICAgICAgY29uc3QgYldpbGRjYXJkSW5kZXggPSBiUGFydHMuaW5kZXhPZignKicpO1xuXG4gICAgICAvLyBJZiBvbmx5IG9uZSBvZiB0aGUgcGF0dGVybnMgaGFzIGEgd2lsZGNhcmQsIG1vdmUgaXQgZG93biBpbiB0aGUgbGlzdFxuICAgICAgaWYgKGFXaWxkY2FyZEluZGV4ID09PSAtMSAmJiBiV2lsZGNhcmRJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgICAgfVxuXG4gICAgICBpZiAoYVdpbGRjYXJkSW5kZXggIT09IC0xICYmIGJXaWxkY2FyZEluZGV4ID09PSAtMSkge1xuICAgICAgICByZXR1cm4gMTtcbiAgICAgIH1cblxuICAgICAgaWYgKGFXaWxkY2FyZEluZGV4ID09PSBiV2lsZGNhcmRJbmRleCkge1xuICAgICAgICAvLyBJZiBgYmAgaGFzIG1vcmUgYC9gLCBpdCdzIG1vcmUgZXhoYXVzdGl2ZVxuICAgICAgICAvLyBTbyB3ZSBtb3ZlIGl0IHVwIGluIHRoZSBsaXN0XG4gICAgICAgIHJldHVybiBiUGFydHMubGVuZ3RoIC0gYVBhcnRzLmxlbmd0aDtcbiAgICAgIH1cblxuICAgICAgLy8gSWYgdGhlIHdpbGRjYXJkIGFwcGVhcnMgbGF0ZXIgaW4gdGhlIHBhdHRlcm4gKGhhcyBoaWdoZXIgaW5kZXgpLCBpdCdzIG1vcmUgc3BlY2lmaWNcbiAgICAgIC8vIFNvIHdlIG1vdmUgaXQgdXAgaW4gdGhlIGxpc3RcbiAgICAgIHJldHVybiBiV2lsZGNhcmRJbmRleCAtIGFXaWxkY2FyZEluZGV4O1xuICAgIH0pO1xuXG4gIC8vIENoZWNrIGZvciBkdXBsaWNhdGUgcGF0dGVybnMgaW4gdGhlIGNvbmZpZ1xuICBjb25maWdzLnJlZHVjZTxSZWNvcmQ8c3RyaW5nLCBSb3V0ZUNvbmZpZz4+KChhY2MsIGNvbmZpZykgPT4ge1xuICAgIGlmIChhY2NbY29uZmlnLnBhdHRlcm5dKSB7XG4gICAgICBjb25zdCBhID0gYWNjW2NvbmZpZy5wYXR0ZXJuXS5yb3V0ZU5hbWVzO1xuICAgICAgY29uc3QgYiA9IGNvbmZpZy5yb3V0ZU5hbWVzO1xuXG4gICAgICAvLyBJdCdzIG5vdCBhIHByb2JsZW0gaWYgdGhlIHBhdGggc3RyaW5nIG9taXR0ZWQgZnJvbSBhIGlubmVyIG1vc3Qgc2NyZWVuXG4gICAgICAvLyBGb3IgZXhhbXBsZSwgaXQncyBvayBpZiBhIHBhdGggcmVzb2x2ZXMgdG8gYEEgPiBCID4gQ2Agb3IgYEEgPiBCYFxuICAgICAgY29uc3QgaW50ZXJzZWN0cyA9XG4gICAgICAgIGEubGVuZ3RoID4gYi5sZW5ndGhcbiAgICAgICAgICA/IGIuZXZlcnkoKGl0LCBpKSA9PiBhW2ldID09PSBpdClcbiAgICAgICAgICA6IGEuZXZlcnkoKGl0LCBpKSA9PiBiW2ldID09PSBpdCk7XG5cbiAgICAgIGlmICghaW50ZXJzZWN0cykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgYEZvdW5kIGNvbmZsaWN0aW5nIHNjcmVlbnMgd2l0aCB0aGUgc2FtZSBwYXR0ZXJuLiBUaGUgcGF0dGVybiAnJHtcbiAgICAgICAgICAgIGNvbmZpZy5wYXR0ZXJuXG4gICAgICAgICAgfScgcmVzb2x2ZXMgdG8gYm90aCAnJHthLmpvaW4oJyA+ICcpfScgYW5kICcke2Iuam9pbihcbiAgICAgICAgICAgICcgPiAnXG4gICAgICAgICAgKX0nLiBQYXR0ZXJucyBtdXN0IGJlIHVuaXF1ZSBhbmQgY2Fubm90IHJlc29sdmUgdG8gbW9yZSB0aGFuIG9uZSBzY3JlZW4uYFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBPYmplY3QuYXNzaWduKGFjYywge1xuICAgICAgW2NvbmZpZy5wYXR0ZXJuXTogY29uZmlnLFxuICAgIH0pO1xuICB9LCB7fSk7XG5cbiAgaWYgKHJlbWFpbmluZyA9PT0gJy8nKSB7XG4gICAgLy8gV2UgbmVlZCB0byBhZGQgc3BlY2lhbCBoYW5kbGluZyBvZiBlbXB0eSBwYXRoIHNvIG5hdmlnYXRpb24gdG8gZW1wdHkgcGF0aCBhbHNvIHdvcmtzXG4gICAgLy8gV2hlbiBoYW5kbGluZyBlbXB0eSBwYXRoLCB3ZSBzaG91bGQgb25seSBsb29rIGF0IHRoZSByb290IGxldmVsIGNvbmZpZ1xuICAgIGNvbnN0IG1hdGNoID0gY29uZmlncy5maW5kKFxuICAgICAgKGNvbmZpZykgPT5cbiAgICAgICAgY29uZmlnLnBhdGggPT09ICcnICYmXG4gICAgICAgIGNvbmZpZy5yb3V0ZU5hbWVzLmV2ZXJ5KFxuICAgICAgICAgIC8vIE1ha2Ugc3VyZSB0aGF0IG5vbmUgb2YgdGhlIHBhcmVudCBjb25maWdzIGhhdmUgYSBub24tZW1wdHkgcGF0aCBkZWZpbmVkXG4gICAgICAgICAgKG5hbWUpID0+ICFjb25maWdzLmZpbmQoKGMpID0+IGMuc2NyZWVuID09PSBuYW1lKT8ucGF0aFxuICAgICAgICApXG4gICAgKTtcblxuICAgIGlmIChtYXRjaCkge1xuICAgICAgcmV0dXJuIGNyZWF0ZU5lc3RlZFN0YXRlT2JqZWN0KFxuICAgICAgICBtYXRjaC5yb3V0ZU5hbWVzLm1hcCgobmFtZSwgaSwgc2VsZikgPT4ge1xuICAgICAgICAgIGlmIChpID09PSBzZWxmLmxlbmd0aCAtIDEpIHtcbiAgICAgICAgICAgIHJldHVybiB7IG5hbWUsIHBhcmFtczogcGFyc2VRdWVyeVBhcmFtcyhwYXRoLCBtYXRjaC5wYXJzZSkgfTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICByZXR1cm4geyBuYW1lIH07XG4gICAgICAgIH0pLFxuICAgICAgICBpbml0aWFsUm91dGVzXG4gICAgICApO1xuICAgIH1cblxuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH1cblxuICBsZXQgcmVzdWx0OiBQYXJ0aWFsU3RhdGU8TmF2aWdhdGlvblN0YXRlPiB8IHVuZGVmaW5lZDtcbiAgbGV0IGN1cnJlbnQ6IFBhcnRpYWxTdGF0ZTxOYXZpZ2F0aW9uU3RhdGU+IHwgdW5kZWZpbmVkO1xuXG4gIGlmIChsZWdhY3kgPT09IGZhbHNlKSB7XG4gICAgLy8gSWYgd2UncmUgbm90IGluIGxlZ2FjeSBtb2RlLCwgd2UgbWF0Y2ggdGhlIHdob2xlIHBhdGggYWdhaW5zdCB0aGUgcmVnZXggaW5zdGVhZCBvZiBzZWdtZW50c1xuICAgIC8vIFRoaXMgbWFrZXMgc3VyZSBtYXRjaGVzIHN1Y2ggYXMgd2lsZGNhcmQgd2lsbCBjYXRjaCBhbnkgdW5tYXRjaGVkIHJvdXRlcywgZXZlbiBpZiBuZXN0ZWRcbiAgICBjb25zdCB7IHJvdXRlcywgcmVtYWluaW5nUGF0aCB9ID0gbWF0Y2hBZ2FpbnN0Q29uZmlncyhcbiAgICAgIHJlbWFpbmluZyxcbiAgICAgIGNvbmZpZ3MubWFwKChjKSA9PiAoe1xuICAgICAgICAuLi5jLFxuICAgICAgICAvLyBBZGQgYCRgIHRvIHRoZSByZWdleCB0byBtYWtlIHN1cmUgaXQgbWF0Y2hlcyB0aWxsIGVuZCBvZiB0aGUgcGF0aCBhbmQgbm90IGp1c3QgYmVnaW5uaW5nXG4gICAgICAgIHJlZ2V4OiBjLnJlZ2V4ID8gbmV3IFJlZ0V4cChjLnJlZ2V4LnNvdXJjZSArICckJykgOiB1bmRlZmluZWQsXG4gICAgICB9KSlcbiAgICApO1xuXG4gICAgaWYgKHJvdXRlcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAvLyBUaGlzIHdpbGwgYWx3YXlzIGJlIGVtcHR5IGlmIGZ1bGwgcGF0aCBtYXRjaGVkXG4gICAgICBjdXJyZW50ID0gY3JlYXRlTmVzdGVkU3RhdGVPYmplY3Qocm91dGVzLCBpbml0aWFsUm91dGVzKTtcbiAgICAgIHJlbWFpbmluZyA9IHJlbWFpbmluZ1BhdGg7XG4gICAgICByZXN1bHQgPSBjdXJyZW50O1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICAvLyBJbiBsZWdhY3kgbW9kZSwgd2UgZGl2aWRlIHRoZSBwYXRoIGludG8gc2VnbWVudHMgYW5kIG1hdGNoIHBpZWNlIGJ5IHBpZWNlXG4gICAgLy8gVGhpcyBwcmVzZXJ2ZXMgdGhlIGxlZ2FjeSBiZWhhdmlvdXIsIGJ1dCB3ZSBzaG91bGQgcmVtb3ZlIGl0IGluIG5leHQgbWFqb3JcbiAgICB3aGlsZSAocmVtYWluaW5nKSB7XG4gICAgICBsZXQgeyByb3V0ZXMsIHJlbWFpbmluZ1BhdGggfSA9IG1hdGNoQWdhaW5zdENvbmZpZ3MocmVtYWluaW5nLCBjb25maWdzKTtcblxuICAgICAgcmVtYWluaW5nID0gcmVtYWluaW5nUGF0aDtcblxuICAgICAgLy8gSWYgd2UgaGFkbid0IG1hdGNoZWQgYW55IHNlZ21lbnRzIGVhcmxpZXIsIHVzZSB0aGUgcGF0aCBhcyByb3V0ZSBuYW1lXG4gICAgICBpZiAocm91dGVzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgY29uc3Qgc2VnbWVudHMgPSByZW1haW5pbmcuc3BsaXQoJy8nKTtcblxuICAgICAgICByb3V0ZXMgPSBbeyBuYW1lOiBkZWNvZGVVUklDb21wb25lbnQoc2VnbWVudHNbMF0pIH1dO1xuICAgICAgICBzZWdtZW50cy5zaGlmdCgpO1xuICAgICAgICByZW1haW5pbmcgPSBzZWdtZW50cy5qb2luKCcvJyk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHN0YXRlID0gY3JlYXRlTmVzdGVkU3RhdGVPYmplY3Qocm91dGVzLCBpbml0aWFsUm91dGVzKTtcblxuICAgICAgaWYgKGN1cnJlbnQpIHtcbiAgICAgICAgLy8gVGhlIHN0YXRlIHNob3VsZCBiZSBuZXN0ZWQgaW5zaWRlIHRoZSBkZWVwZXN0IHJvdXRlIHdlIHBhcnNlZCBiZWZvcmVcbiAgICAgICAgd2hpbGUgKGN1cnJlbnQ/LnJvdXRlc1tjdXJyZW50LmluZGV4IHx8IDBdLnN0YXRlKSB7XG4gICAgICAgICAgY3VycmVudCA9IGN1cnJlbnQucm91dGVzW2N1cnJlbnQuaW5kZXggfHwgMF0uc3RhdGU7XG4gICAgICAgIH1cblxuICAgICAgICAoY3VycmVudCBhcyBQYXJ0aWFsU3RhdGU8TmF2aWdhdGlvblN0YXRlPikucm91dGVzW1xuICAgICAgICAgIGN1cnJlbnQ/LmluZGV4IHx8IDBcbiAgICAgICAgXS5zdGF0ZSA9IHN0YXRlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0ID0gc3RhdGU7XG4gICAgICB9XG5cbiAgICAgIGN1cnJlbnQgPSBzdGF0ZTtcbiAgICB9XG4gIH1cblxuICBpZiAoY3VycmVudCA9PSBudWxsIHx8IHJlc3VsdCA9PSBudWxsKSB7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgfVxuXG4gIGNvbnN0IHJvdXRlID0gZmluZEZvY3VzZWRSb3V0ZShjdXJyZW50KTtcbiAgY29uc3QgcGFyYW1zID0gcGFyc2VRdWVyeVBhcmFtcyhcbiAgICBwYXRoLFxuICAgIGZpbmRQYXJzZUNvbmZpZ0ZvclJvdXRlKHJvdXRlLm5hbWUsIGNvbmZpZ3MpXG4gICk7XG5cbiAgaWYgKHBhcmFtcykge1xuICAgIC8vIEB0cy1leHBlY3QtZXJyb3I6IHBhcmFtcyBzaG91bGQgYmUgdHJlYXRlZCBhcyByZWFkLW9ubHksIGJ1dCB3ZSdyZSBjcmVhdGluZyB0aGUgc3RhdGUgaGVyZSBzbyBpdCBkb2Vzbid0IG1hdHRlclxuICAgIHJvdXRlLnBhcmFtcyA9IHsgLi4ucm91dGUucGFyYW1zLCAuLi5wYXJhbXMgfTtcbiAgfVxuXG4gIHJldHVybiByZXN1bHQ7XG59XG5cbmNvbnN0IGpvaW5QYXRocyA9ICguLi5wYXRoczogc3RyaW5nW10pOiBzdHJpbmcgPT5cbiAgKFtdIGFzIHN0cmluZ1tdKVxuICAgIC5jb25jYXQoLi4ucGF0aHMubWFwKChwKSA9PiBwLnNwbGl0KCcvJykpKVxuICAgIC5maWx0ZXIoQm9vbGVhbilcbiAgICAuam9pbignLycpO1xuXG5jb25zdCBtYXRjaEFnYWluc3RDb25maWdzID0gKHJlbWFpbmluZzogc3RyaW5nLCBjb25maWdzOiBSb3V0ZUNvbmZpZ1tdKSA9PiB7XG4gIGxldCByb3V0ZXM6IFBhcnNlZFJvdXRlW10gfCB1bmRlZmluZWQ7XG4gIGxldCByZW1haW5pbmdQYXRoID0gcmVtYWluaW5nO1xuXG4gIC8vIEdvIHRocm91Z2ggYWxsIGNvbmZpZ3MsIGFuZCBzZWUgaWYgdGhlIG5leHQgcGF0aCBzZWdtZW50IG1hdGNoZXMgb3VyIHJlZ2V4XG4gIGZvciAoY29uc3QgY29uZmlnIG9mIGNvbmZpZ3MpIHtcbiAgICBpZiAoIWNvbmZpZy5yZWdleCkge1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgY29uc3QgbWF0Y2ggPSByZW1haW5pbmdQYXRoLm1hdGNoKGNvbmZpZy5yZWdleCk7XG5cbiAgICAvLyBJZiBvdXIgcmVnZXggbWF0Y2hlcywgd2UgbmVlZCB0byBleHRyYWN0IHBhcmFtcyBmcm9tIHRoZSBwYXRoXG4gICAgaWYgKG1hdGNoKSB7XG4gICAgICBjb25zdCBtYXRjaGVkUGFyYW1zID0gY29uZmlnLnBhdHRlcm5cbiAgICAgICAgPy5zcGxpdCgnLycpXG4gICAgICAgIC5maWx0ZXIoKHApID0+IHAuc3RhcnRzV2l0aCgnOicpKVxuICAgICAgICAucmVkdWNlPFJlY29yZDxzdHJpbmcsIGFueT4+KFxuICAgICAgICAgIChhY2MsIHAsIGkpID0+XG4gICAgICAgICAgICBPYmplY3QuYXNzaWduKGFjYywge1xuICAgICAgICAgICAgICAvLyBUaGUgcGFyYW0gc2VnbWVudHMgYXBwZWFyIGV2ZXJ5IHNlY29uZCBpdGVtIHN0YXJ0aW5nIGZyb20gMiBpbiB0aGUgcmVnZXggbWF0Y2ggcmVzdWx0XG4gICAgICAgICAgICAgIFtwXTogbWF0Y2ghWyhpICsgMSkgKiAyXS5yZXBsYWNlKC9cXC8vLCAnJyksXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgICB7fVxuICAgICAgICApO1xuXG4gICAgICByb3V0ZXMgPSBjb25maWcucm91dGVOYW1lcy5tYXAoKG5hbWUpID0+IHtcbiAgICAgICAgY29uc3QgY29uZmlnID0gY29uZmlncy5maW5kKChjKSA9PiBjLnNjcmVlbiA9PT0gbmFtZSk7XG4gICAgICAgIGNvbnN0IHBhcmFtcyA9IGNvbmZpZz8ucGF0aFxuICAgICAgICAgID8uc3BsaXQoJy8nKVxuICAgICAgICAgIC5maWx0ZXIoKHApID0+IHAuc3RhcnRzV2l0aCgnOicpKVxuICAgICAgICAgIC5yZWR1Y2U8UmVjb3JkPHN0cmluZywgYW55Pj4oKGFjYywgcCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSBtYXRjaGVkUGFyYW1zW3BdO1xuXG4gICAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgY29uc3Qga2V5ID0gcC5yZXBsYWNlKC9eOi8sICcnKS5yZXBsYWNlKC9cXD8kLywgJycpO1xuICAgICAgICAgICAgICBhY2Nba2V5XSA9IGNvbmZpZy5wYXJzZT8uW2tleV0gPyBjb25maWcucGFyc2Vba2V5XSh2YWx1ZSkgOiB2YWx1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgICAgICB9LCB7fSk7XG5cbiAgICAgICAgaWYgKHBhcmFtcyAmJiBPYmplY3Qua2V5cyhwYXJhbXMpLmxlbmd0aCkge1xuICAgICAgICAgIHJldHVybiB7IG5hbWUsIHBhcmFtcyB9O1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHsgbmFtZSB9O1xuICAgICAgfSk7XG5cbiAgICAgIHJlbWFpbmluZ1BhdGggPSByZW1haW5pbmdQYXRoLnJlcGxhY2UobWF0Y2hbMV0sICcnKTtcblxuICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHsgcm91dGVzLCByZW1haW5pbmdQYXRoIH07XG59O1xuXG5jb25zdCBjcmVhdGVOb3JtYWxpemVkQ29uZmlncyA9IChcbiAgbGVnYWN5OiBib29sZWFuLFxuICBzY3JlZW46IHN0cmluZyxcbiAgcm91dGVDb25maWc6IFBhdGhDb25maWdNYXAsXG4gIHJvdXRlTmFtZXM6IHN0cmluZ1tdID0gW10sXG4gIGluaXRpYWxzOiBJbml0aWFsUm91dGVDb25maWdbXSxcbiAgcGFyZW50UGF0dGVybj86IHN0cmluZ1xuKTogUm91dGVDb25maWdbXSA9PiB7XG4gIGNvbnN0IGNvbmZpZ3M6IFJvdXRlQ29uZmlnW10gPSBbXTtcblxuICByb3V0ZU5hbWVzLnB1c2goc2NyZWVuKTtcblxuICBjb25zdCBjb25maWcgPSByb3V0ZUNvbmZpZ1tzY3JlZW5dO1xuXG4gIGlmICh0eXBlb2YgY29uZmlnID09PSAnc3RyaW5nJykge1xuICAgIC8vIElmIGEgc3RyaW5nIGlzIHNwZWNpZmllZCBhcyB0aGUgdmFsdWUgb2YgdGhlIGtleShlLmcuIEZvbzogJy9wYXRoJyksIHVzZSBpdCBhcyB0aGUgcGF0dGVyblxuICAgIGNvbnN0IHBhdHRlcm4gPSBwYXJlbnRQYXR0ZXJuID8gam9pblBhdGhzKHBhcmVudFBhdHRlcm4sIGNvbmZpZykgOiBjb25maWc7XG5cbiAgICBjb25maWdzLnB1c2goY3JlYXRlQ29uZmlnSXRlbShsZWdhY3ksIHNjcmVlbiwgcm91dGVOYW1lcywgcGF0dGVybiwgY29uZmlnKSk7XG4gIH0gZWxzZSBpZiAodHlwZW9mIGNvbmZpZyA9PT0gJ29iamVjdCcpIHtcbiAgICBsZXQgcGF0dGVybjogc3RyaW5nIHwgdW5kZWZpbmVkO1xuXG4gICAgLy8gaWYgYW4gb2JqZWN0IGlzIHNwZWNpZmllZCBhcyB0aGUgdmFsdWUgKGUuZy4gRm9vOiB7IC4uLiB9KSxcbiAgICAvLyBpdCBjYW4gaGF2ZSBgcGF0aGAgcHJvcGVydHkgYW5kXG4gICAgLy8gaXQgY291bGQgaGF2ZSBgc2NyZWVuc2AgcHJvcCB3aGljaCBoYXMgbmVzdGVkIGNvbmZpZ3NcbiAgICBpZiAodHlwZW9mIGNvbmZpZy5wYXRoID09PSAnc3RyaW5nJykge1xuICAgICAgaWYgKGxlZ2FjeSkge1xuICAgICAgICBwYXR0ZXJuID1cbiAgICAgICAgICBjb25maWcuZXhhY3QgIT09IHRydWUgJiYgcGFyZW50UGF0dGVyblxuICAgICAgICAgICAgPyBqb2luUGF0aHMocGFyZW50UGF0dGVybiwgY29uZmlnLnBhdGgpXG4gICAgICAgICAgICA6IGNvbmZpZy5wYXRoO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaWYgKGNvbmZpZy5leGFjdCAmJiBjb25maWcucGF0aCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFxuICAgICAgICAgICAgXCJBICdwYXRoJyBuZWVkcyB0byBiZSBzcGVjaWZpZWQgd2hlbiBzcGVjaWZ5aW5nICdleGFjdDogdHJ1ZScuIElmIHlvdSBkb24ndCB3YW50IHRoaXMgc2NyZWVuIGluIHRoZSBVUkwsIHNwZWNpZnkgaXQgYXMgZW1wdHkgc3RyaW5nLCBlLmcuIGBwYXRoOiAnJ2AuXCJcbiAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgcGF0dGVybiA9XG4gICAgICAgICAgY29uZmlnLmV4YWN0ICE9PSB0cnVlXG4gICAgICAgICAgICA/IGpvaW5QYXRocyhwYXJlbnRQYXR0ZXJuIHx8ICcnLCBjb25maWcucGF0aCB8fCAnJylcbiAgICAgICAgICAgIDogY29uZmlnLnBhdGggfHwgJyc7XG4gICAgICB9XG5cbiAgICAgIGNvbmZpZ3MucHVzaChcbiAgICAgICAgY3JlYXRlQ29uZmlnSXRlbShcbiAgICAgICAgICBsZWdhY3ksXG4gICAgICAgICAgc2NyZWVuLFxuICAgICAgICAgIHJvdXRlTmFtZXMsXG4gICAgICAgICAgcGF0dGVybixcbiAgICAgICAgICBjb25maWcucGF0aCxcbiAgICAgICAgICBjb25maWcucGFyc2VcbiAgICAgICAgKVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoY29uZmlnLnNjcmVlbnMpIHtcbiAgICAgIC8vIHByb3BlcnR5IGBpbml0aWFsUm91dGVOYW1lYCB3aXRob3V0IGBzY3JlZW5zYCBoYXMgbm8gcHVycG9zZVxuICAgICAgaWYgKGNvbmZpZy5pbml0aWFsUm91dGVOYW1lKSB7XG4gICAgICAgIGluaXRpYWxzLnB1c2goe1xuICAgICAgICAgIGluaXRpYWxSb3V0ZU5hbWU6IGNvbmZpZy5pbml0aWFsUm91dGVOYW1lLFxuICAgICAgICAgIGNvbm5lY3RlZFJvdXRlczogT2JqZWN0LmtleXMoY29uZmlnLnNjcmVlbnMpLFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgT2JqZWN0LmtleXMoY29uZmlnLnNjcmVlbnMpLmZvckVhY2goKG5lc3RlZENvbmZpZykgPT4ge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBjcmVhdGVOb3JtYWxpemVkQ29uZmlncyhcbiAgICAgICAgICBsZWdhY3ksXG4gICAgICAgICAgbmVzdGVkQ29uZmlnLFxuICAgICAgICAgIGNvbmZpZy5zY3JlZW5zIGFzIFBhdGhDb25maWdNYXAsXG4gICAgICAgICAgcm91dGVOYW1lcyxcbiAgICAgICAgICBpbml0aWFscyxcbiAgICAgICAgICBwYXR0ZXJuID8/IHBhcmVudFBhdHRlcm5cbiAgICAgICAgKTtcblxuICAgICAgICBjb25maWdzLnB1c2goLi4ucmVzdWx0KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHJvdXRlTmFtZXMucG9wKCk7XG5cbiAgcmV0dXJuIGNvbmZpZ3M7XG59O1xuXG5jb25zdCBjcmVhdGVDb25maWdJdGVtID0gKFxuICBsZWdhY3k6IGJvb2xlYW4sXG4gIHNjcmVlbjogc3RyaW5nLFxuICByb3V0ZU5hbWVzOiBzdHJpbmdbXSxcbiAgcGF0dGVybjogc3RyaW5nLFxuICBwYXRoOiBzdHJpbmcsXG4gIHBhcnNlPzogUGFyc2VDb25maWdcbik6IFJvdXRlQ29uZmlnID0+IHtcbiAgLy8gTm9ybWFsaXplIHBhdHRlcm4gdG8gcmVtb3ZlIGFueSBsZWFkaW5nLCB0cmFpbGluZyBzbGFzaGVzLCBkdXBsaWNhdGUgc2xhc2hlcyBldGMuXG4gIHBhdHRlcm4gPSBwYXR0ZXJuLnNwbGl0KCcvJykuZmlsdGVyKEJvb2xlYW4pLmpvaW4oJy8nKTtcblxuICBjb25zdCByZWdleCA9IHBhdHRlcm5cbiAgICA/IG5ldyBSZWdFeHAoXG4gICAgICAgIGBeKCR7cGF0dGVyblxuICAgICAgICAgIC5zcGxpdCgnLycpXG4gICAgICAgICAgLm1hcCgoaXQpID0+IHtcbiAgICAgICAgICAgIGlmIChsZWdhY3kgJiYgaXQgPT09ICcqJykge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgICAgICAgXCJQbGVhc2UgdXBkYXRlIHlvdXIgY29uZmlnIHRvIHRoZSBuZXcgZm9ybWF0IHRvIHVzZSB3aWxkY2FyZCBwYXR0ZXJuICgnKicpLiBodHRwczovL3JlYWN0bmF2aWdhdGlvbi5vcmcvZG9jcy9jb25maWd1cmluZy1saW5rcy8jdXBkYXRpbmctY29uZmlnXCJcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGl0LnN0YXJ0c1dpdGgoJzonKSkge1xuICAgICAgICAgICAgICByZXR1cm4gYCgoW14vXStcXFxcLykke2l0LmVuZHNXaXRoKCc/JykgPyAnPycgOiAnJ30pYDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGAke2l0ID09PSAnKicgPyAnLionIDogZXNjYXBlKGl0KX1cXFxcL2A7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuam9pbignJyl9KWBcbiAgICAgIClcbiAgICA6IHVuZGVmaW5lZDtcblxuICByZXR1cm4ge1xuICAgIHNjcmVlbixcbiAgICByZWdleCxcbiAgICBwYXR0ZXJuLFxuICAgIHBhdGgsXG4gICAgLy8gVGhlIHJvdXRlTmFtZXMgYXJyYXkgaXMgbXV0YXRlZCwgc28gY29weSBpdCB0byBrZWVwIHRoZSBjdXJyZW50IHN0YXRlXG4gICAgcm91dGVOYW1lczogWy4uLnJvdXRlTmFtZXNdLFxuICAgIHBhcnNlLFxuICB9O1xufTtcblxuY29uc3QgZmluZFBhcnNlQ29uZmlnRm9yUm91dGUgPSAoXG4gIHJvdXRlTmFtZTogc3RyaW5nLFxuICBmbGF0Q29uZmlnOiBSb3V0ZUNvbmZpZ1tdXG4pOiBQYXJzZUNvbmZpZyB8IHVuZGVmaW5lZCA9PiB7XG4gIGZvciAoY29uc3QgY29uZmlnIG9mIGZsYXRDb25maWcpIHtcbiAgICBpZiAocm91dGVOYW1lID09PSBjb25maWcucm91dGVOYW1lc1tjb25maWcucm91dGVOYW1lcy5sZW5ndGggLSAxXSkge1xuICAgICAgcmV0dXJuIGNvbmZpZy5wYXJzZTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gdW5kZWZpbmVkO1xufTtcblxuLy8gVHJ5IHRvIGZpbmQgYW4gaW5pdGlhbCByb3V0ZSBjb25uZWN0ZWQgd2l0aCB0aGUgb25lIHBhc3NlZFxuY29uc3QgZmluZEluaXRpYWxSb3V0ZSA9IChcbiAgcm91dGVOYW1lOiBzdHJpbmcsXG4gIGluaXRpYWxSb3V0ZXM6IEluaXRpYWxSb3V0ZUNvbmZpZ1tdXG4pOiBzdHJpbmcgfCB1bmRlZmluZWQgPT4ge1xuICBmb3IgKGNvbnN0IGNvbmZpZyBvZiBpbml0aWFsUm91dGVzKSB7XG4gICAgaWYgKGNvbmZpZy5jb25uZWN0ZWRSb3V0ZXMuaW5jbHVkZXMocm91dGVOYW1lKSkge1xuICAgICAgcmV0dXJuIGNvbmZpZy5pbml0aWFsUm91dGVOYW1lID09PSByb3V0ZU5hbWVcbiAgICAgICAgPyB1bmRlZmluZWRcbiAgICAgICAgOiBjb25maWcuaW5pdGlhbFJvdXRlTmFtZTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHVuZGVmaW5lZDtcbn07XG5cbi8vIHJldHVybnMgc3RhdGUgb2JqZWN0IHdpdGggdmFsdWVzIGRlcGVuZGluZyBvbiB3aGV0aGVyXG4vLyBpdCBpcyB0aGUgZW5kIG9mIHN0YXRlIGFuZCBpZiB0aGVyZSBpcyBpbml0aWFsUm91dGUgZm9yIHRoaXMgbGV2ZWxcbmNvbnN0IGNyZWF0ZVN0YXRlT2JqZWN0ID0gKFxuICBpbml0aWFsUm91dGU6IHN0cmluZyB8IHVuZGVmaW5lZCxcbiAgcm91dGU6IFBhcnNlZFJvdXRlLFxuICBpc0VtcHR5OiBib29sZWFuXG4pOiBJbml0aWFsU3RhdGUgPT4ge1xuICBpZiAoaXNFbXB0eSkge1xuICAgIGlmIChpbml0aWFsUm91dGUpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGluZGV4OiAxLFxuICAgICAgICByb3V0ZXM6IFt7IG5hbWU6IGluaXRpYWxSb3V0ZSB9LCByb3V0ZV0sXG4gICAgICB9O1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICByb3V0ZXM6IFtyb3V0ZV0sXG4gICAgICB9O1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBpZiAoaW5pdGlhbFJvdXRlKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBpbmRleDogMSxcbiAgICAgICAgcm91dGVzOiBbeyBuYW1lOiBpbml0aWFsUm91dGUgfSwgeyAuLi5yb3V0ZSwgc3RhdGU6IHsgcm91dGVzOiBbXSB9IH1dLFxuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgcm91dGVzOiBbeyAuLi5yb3V0ZSwgc3RhdGU6IHsgcm91dGVzOiBbXSB9IH1dLFxuICAgICAgfTtcbiAgICB9XG4gIH1cbn07XG5cbmNvbnN0IGNyZWF0ZU5lc3RlZFN0YXRlT2JqZWN0ID0gKFxuICByb3V0ZXM6IFBhcnNlZFJvdXRlW10sXG4gIGluaXRpYWxSb3V0ZXM6IEluaXRpYWxSb3V0ZUNvbmZpZ1tdXG4pID0+IHtcbiAgbGV0IHN0YXRlOiBJbml0aWFsU3RhdGU7XG4gIGxldCByb3V0ZSA9IHJvdXRlcy5zaGlmdCgpIGFzIFBhcnNlZFJvdXRlO1xuICBsZXQgaW5pdGlhbFJvdXRlID0gZmluZEluaXRpYWxSb3V0ZShyb3V0ZS5uYW1lLCBpbml0aWFsUm91dGVzKTtcblxuICBzdGF0ZSA9IGNyZWF0ZVN0YXRlT2JqZWN0KGluaXRpYWxSb3V0ZSwgcm91dGUsIHJvdXRlcy5sZW5ndGggPT09IDApO1xuXG4gIGlmIChyb3V0ZXMubGVuZ3RoID4gMCkge1xuICAgIGxldCBuZXN0ZWRTdGF0ZSA9IHN0YXRlO1xuXG4gICAgd2hpbGUgKChyb3V0ZSA9IHJvdXRlcy5zaGlmdCgpIGFzIFBhcnNlZFJvdXRlKSkge1xuICAgICAgaW5pdGlhbFJvdXRlID0gZmluZEluaXRpYWxSb3V0ZShyb3V0ZS5uYW1lLCBpbml0aWFsUm91dGVzKTtcblxuICAgICAgY29uc3QgbmVzdGVkU3RhdGVJbmRleCA9XG4gICAgICAgIG5lc3RlZFN0YXRlLmluZGV4IHx8IG5lc3RlZFN0YXRlLnJvdXRlcy5sZW5ndGggLSAxO1xuXG4gICAgICBuZXN0ZWRTdGF0ZS5yb3V0ZXNbbmVzdGVkU3RhdGVJbmRleF0uc3RhdGUgPSBjcmVhdGVTdGF0ZU9iamVjdChcbiAgICAgICAgaW5pdGlhbFJvdXRlLFxuICAgICAgICByb3V0ZSxcbiAgICAgICAgcm91dGVzLmxlbmd0aCA9PT0gMFxuICAgICAgKTtcblxuICAgICAgaWYgKHJvdXRlcy5sZW5ndGggPiAwKSB7XG4gICAgICAgIG5lc3RlZFN0YXRlID0gbmVzdGVkU3RhdGUucm91dGVzW25lc3RlZFN0YXRlSW5kZXhdXG4gICAgICAgICAgLnN0YXRlIGFzIEluaXRpYWxTdGF0ZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByZXR1cm4gc3RhdGU7XG59O1xuXG5jb25zdCBmaW5kRm9jdXNlZFJvdXRlID0gKHN0YXRlOiBJbml0aWFsU3RhdGUpID0+IHtcbiAgbGV0IGN1cnJlbnQ6IEluaXRpYWxTdGF0ZSB8IHVuZGVmaW5lZCA9IHN0YXRlO1xuXG4gIHdoaWxlIChjdXJyZW50Py5yb3V0ZXNbY3VycmVudC5pbmRleCB8fCAwXS5zdGF0ZSkge1xuICAgIC8vIFRoZSBxdWVyeSBwYXJhbXMgYXBwbHkgdG8gdGhlIGRlZXBlc3Qgcm91dGVcbiAgICBjdXJyZW50ID0gY3VycmVudC5yb3V0ZXNbY3VycmVudC5pbmRleCB8fCAwXS5zdGF0ZTtcbiAgfVxuXG4gIGNvbnN0IHJvdXRlID0gKGN1cnJlbnQgYXMgUGFydGlhbFN0YXRlPE5hdmlnYXRpb25TdGF0ZT4pLnJvdXRlc1tcbiAgICBjdXJyZW50Py5pbmRleCB8fCAwXG4gIF07XG5cbiAgcmV0dXJuIHJvdXRlO1xufTtcblxuY29uc3QgcGFyc2VRdWVyeVBhcmFtcyA9IChcbiAgcGF0aDogc3RyaW5nLFxuICBwYXJzZUNvbmZpZz86IFJlY29yZDxzdHJpbmcsICh2YWx1ZTogc3RyaW5nKSA9PiBhbnk+XG4pID0+IHtcbiAgY29uc3QgcXVlcnkgPSBwYXRoLnNwbGl0KCc/JylbMV07XG4gIGNvbnN0IHBhcmFtcyA9IHF1ZXJ5U3RyaW5nLnBhcnNlKHF1ZXJ5KTtcblxuICBpZiAocGFyc2VDb25maWcpIHtcbiAgICBPYmplY3Qua2V5cyhwYXJhbXMpLmZvckVhY2goKG5hbWUpID0+IHtcbiAgICAgIGlmIChwYXJzZUNvbmZpZ1tuYW1lXSAmJiB0eXBlb2YgcGFyYW1zW25hbWVdID09PSAnc3RyaW5nJykge1xuICAgICAgICBwYXJhbXNbbmFtZV0gPSBwYXJzZUNvbmZpZ1tuYW1lXShwYXJhbXNbbmFtZV0gYXMgc3RyaW5nKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBPYmplY3Qua2V5cyhwYXJhbXMpLmxlbmd0aCA/IHBhcmFtcyA6IHVuZGVmaW5lZDtcbn07XG4iXX0=